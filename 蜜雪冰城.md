![需求分析](./images/需求分析.png)

## 初始化项目

#### 创建项目

1. 使用测试号登录选用 TypeScript + Sass 版本的模板，进入项目

2. 先创建底部导航部分

*app.json*

```js
   {
     "pages": [
       "pages/index/index",
       "pages/menu/index",
       "pages/order/index",
       "pages/me/index"
     ],
     "window": {
       "backgroundTextStyle": "light",
       "navigationBarBackgroundColor": "#fff",
       "navigationBarTitleText": "Weixin",
       "navigationBarTextStyle": "black"
     },
     "tabBar": {
       "list": [
         {
           "pagePath": "pages/index/index",
           "text": "首页"
         },
         {
           "pagePath": "pages/menu/index",
           "text": "点餐"
         },
         {
           "pagePath": "pages/order/index",
           "text": "订单"
         },
         {
           "pagePath": "pages/me/index",
           "text": "我的"
         }
       ]
     },
     "style": "v2",
     "sitemapLocation": "sitemap.json"
   }
```

#### 首页轮播图和轮播图页面的跳转

1. project.config.json 中的 TypeScript 删除和 app.js 中的语法错误删除

```js
// project.config.json

"setting": {
    "useCompilerPlugins": [
      // "typescript",
      "sass"
    ],
        
// app.js 
App<IAppOption>({   -->   APP({})
```

2. pages/index/index.json

```js
{
  "navigationStyle": "custom"
} 
// 取消头部导航栏部分，这样就可以撑满整个屏幕
```

3.  pages/index/index.wxml

```html
   <view class="page">
    <view class="swiper-container">
     <swiper>
      <!-- 轮播里面包括图片，里面一个是轮播一个是轮播标识，里面一个是图片一个是跳转链接 mode="aspectFill" 防止图片变形-->
       <swiper-item wx:for="{{ swiperList }}" wx:key="index">
         <image mode="aspectFill" src="{{ item.imageUrl }}"></image>
       </swiper-item>
     </swiper>
     <view class="dots">
     <!-- 如果 current == index  会有一个 active 属性-->
         
     <view class="dot {{current !== index || 'active'}}" wx:for="{{ swiperList }}" wx:key="index"></view>
     </view>
    </view>
</view>
```

4. pages/index/index.scss

```js
.swiper-container{
  width: 100vw;
  height: 630rpx;
  swiper{
    height: 100%;
    image{
      width: 100%;
      height: 100%;
    }
  }
}
```

## 开始项目

#### 实现轮播图页面按钮样式切换

5. pages/index/index.wxml

```html
<view class="page">
 <view class="swiper-container">
 <!--3. 我们怎么知道图片切换去切换小圆圈的状态呢，这里有个bindchange事件 -->
  <swiper bindchange="onSwiperChange">
   <!--1. 轮播里面包括图片，里面一个是轮播一个是轮播标识，里面一个是图片一个是跳转链接 -->
    <swiper-item wx:for="{{ swiperList }}" wx:key="index">
      <image mode="aspectFill" src="{{ item.imageUrl }}"></image>
    </swiper-item>
  </swiper>
  <view class="dots">
  <!--2. 如果 current == index  会有一个 active 属性-->
  <view class="dot {{current !== index || 'active'}}" wx:for="{{ swiperList }}" wx:key="index"></view>
  </view>
 </view>
</view>
```

6. pages/index/index.scss

```scss
.swiper-container{
  width: 100vw;
  height: 630rpx;
  position: relative;
  swiper{
    height: 100%;
    image{
      width: 100%;
      height: 100%;
      // 下面有一点的弧度
      border-bottom-left-radius: 20rpx;
      border-bottom-right-radius: 20rpx;
    }
  }
  // 固定的区域，轮播图里面的切换图片的小标识
  .dots{
    position: absolute;
    left: 50rpx;
    bottom: 50rpx;
    // 这样的话下面的 dot 小圆圈就可以按照flex进行排布
    display: inline-flex;
    .dot{
      width: 8rpx;
      height: 8rpx;
      background-color: #fff;
      opacity: .5;
      // 因为上面是正方块，所以这里应该是半径 4rpx 的圆
      border-radius: 4rpx;
      // 每个小圆的间隔是 4rpx
      margin-left: 4rpx;
      // 1s 过渡
      transition: all 1s;
      &.active {
        // 如果是被选中状态的话，那么这里就会从圆变成一个条状的切换样式
        width: 29rpx;
        opacity: 1;
      }
    }
  }
}
```

7. pages/index/index.js

```js
// pages/index/index.ts
Page({

  /**
   * 页面的初始数据
   */
  data: {
    swiperList:[
      {
        imageUrl:'../../assets/images/lb1.png',
        type:'url',
        target:"http://baidu.com"
      },
      {
        imageUrl:'../../assets/images/lb2.png',
        // 跳转到产品具体的详情页
        type:'product',
        target:"1"
      },
      {
        imageUrl:'../../assets/images/lb3.png',
        type:'url',
        target:"http://baidu.com"
      }
    ],
    current:0
  },
  // 当轮播图切换的时候，调用这个方法，给 current 重新赋值，改变切换按钮的样式
  onSwiperChange(e){
    // 可以先进行解构，将里面的 current 拿出来
    const { current } = e.detail
    this.setData({
      current
    })
  }
})
```

#### 使用云开发的方式存储数据

1. 云开发-内容管理-访问地址-创建新项目蜜雪冰城-内容模型-新建模型

   ```js
   // 1.内容类型 图片
   1. 展示名称：轮播图
   2. 数据库字段名：imgUri
   3. 资源链接格式：HTTPS
   4. 是否必须：开启
   // 2.内容类型 枚举
   1. 展示名称：跳转类型
   2. 数据库字段名：type
   3. 资源链接格式：url
   4. 枚举元素类型：字符串
   5. 枚举元素：
     5.1 网址 url
     5.2 产品 product
   6. 是否必须：开启
   // 3. 内容类型 单行字符串
   1. 展示名称：目标
   2. 数据库字段名：target
   3. 是否必须：开启
   ```

2. 内容集合-轮播图-新建

   ```js
   1. 传入图片 
   跳转类型：网址 
   目标：https://baodu.com
   2. 传入图片 
   跳转类型：产品
   目标：123
   3. 传入图片
   跳转类型：产品
   目标：2
   ```

3. 获取云开发数据库中的数据

   api/swiper.js

   ```js
   // 这里是获取 swiper 的方式，简答的封装了一层API，获取数据可以通过这种方式获取
   // 但是这样定义之前需要先在 app.js 里面初始化
   import {db} from './cloud-init'
   const list = () => {
     return db.collection('mx_swiper').get();
   }
   
   export default {
     list
   }
   ```

   app.js

   ```js
   // app.ts
   App({
     globalData: {},
     onLaunch() {
       // 初始 cloud 功能，初始一下环境，才能调用方法 const db = wx.cloud.database() 去调用数据库
       wx.cloud.init();
   
       // 展示本地存储能力
       const logs = wx.getStorageSync('logs') || []
       logs.unshift(Date.now())
       wx.setStorageSync('logs', logs)
    
       // 登录
       wx.login({
         success: res => {
           console.log(res.code)
           // 发送 res.code 到后台换取 openId, sessionKey, unionId
         },
       })
     },
   })
   ```

   pages/index/index.js

   ```js
   import swiper from "../../api/swiper"
   
   // pages/index/index.ts
   Page({
     data: {
       // 创建一个空的数组元素   
       swiperList:[],
       current:0
     },
     // 当轮播图切换的时候，调用这个方法，给 current 重新赋值，改变切换按钮的样式
     onSwiperChange(e){
       // 可以先进行解构，将里面的 current 拿出来
       const { current } = e.detail
       this.setData({
         current
       })
     },
     /**
      * 生命周期函数--监听页面加载
      */
     onLoad() {
     // 在这里获取图片，我们通过在 api 里面封装了API，获取云开发中的数据
      swiper.list().then(res=>{
       // console.log(res);
        this.setData({
          swiperList:res.data
        })
      })
     }
   })
   ```

   pages/index/index.wxml

   ```html
   <view class="page">
   <!-- 如果 swiperList 里面没有数据不会渲染轮播图-->
    <view wx:if="{{swiperList.length}}" class="swiper-container">
    <!--3. 我们怎么知道图片切换去切换小圆圈的状态呢，这里有个bindchange事件 -->
     <swiper bindchange="onSwiperChange">
      <!--1. 轮播里面包括图片，里面一个是轮播一个是轮播标识，里面一个是图片一个是跳转链接 -->
       <swiper-item wx:for="{{ swiperList }}" wx:key="index">
         <image mode="aspectFill" src="{{ item.imgUri }}"></image>
       </swiper-item>
     </swiper>
     <view class="dots">
     <!--2. 如果 current == index  会有一个 active 属性-->
     <view class="dot {{current !== index || 'active'}}" wx:for="{{ swiperList }}" wx:key="index"></view>
     </view>
    </view>
   </view>
   ```

#### 实现轮播图的跳转功能

1. pages/index/index.wxml

   ```html
   <view class="page">
    <view wx:if="{{swiperList.length}}" class="swiper-container">
     <swiper bindchange="onSwiperChange">
       <swiper-item wx:for="{{ swiperList }}" wx:key="index">
        <!--绑定一个点击事件，并且把数据item传入，因为后续要对item里面的数据类型进行判断是如何进行跳转的-->   
         <image bindtap="onSwiperTab" data-item="{{item}}" mode="aspectFill" src="{{ item.imgUri }}"></image>
       </swiper-item>
     </swiper>
     <view class="dots">
     <view class="dot {{current !== index || 'active'}}" wx:for="{{ swiperList }}" wx:key="index"></view>
     </view>
    </view>
   </view>
   ```

2. pages/index/index.js

   ```js
   import swiper from "../../api/swiper"
   
   // pages/index/index.ts
   Page({
     data: {
       swiperList:[],
       current:0
     },
     //1. 当轮播图切换的时候，调用这个方法，给 current 重新赋值，改变切换按钮的样式
     onSwiperChange(e){
       // 可以先进行解构，将里面的 current 拿出来
       const { current } = e.detail
       this.setData({
         current
       })
     },
       
     // 轮播图的跳转效果，这里首先对其进行判断
     // 2. 当手指点图片的时候跳转页面
     onSwiperTab(e){
       // 获取传过来的数据，item
       const {item} = e.currentTarget.dataset
       // console.log(item);
       // 如果里面类型是type，说明是跳转的url，走第一个选项，如果不是走第二个
       item.type === 'url' ? wx.navigateTo({
         url: `/pages/web-view/index?url=${item.target}`,
       }) : wx.navigateTo({
         url: `/pages/product/detail?id=${item.target}`,
       })
     },
   
     onLoad() {
     // 在这里获取图片，我们通过在 api 里面封装了API，获取云开发中的数据
      swiper.list().then(res=>{
       // console.log(res);
        this.setData({
          swiperList:res.data
        })
      })
     }
   })
   ```

3. 创建两张页面 app.json

   ```js
   {
     "pages": [
       "pages/index/index",
       "pages/menu/index",
       "pages/order/index",
       "pages/me/index",
         
       // 创建出来两个需要跳转的页面
       "pages/web-view/index",
       "pages/product/detail"
     ],
     "window": {
       "backgroundTextStyle": "light",
       "navigationBarBackgroundColor": "#fff",
       "navigationBarTitleText": "Weixin",
       "navigationBarTextStyle": "black"
     },
     "tabBar": {
       "list": [
         {
           "pagePath": "pages/index/index",
           "text": "首页"
         },
         {
           "pagePath": "pages/menu/index",
           "text": "点餐"
         },
         {
           "pagePath": "pages/order/index",
           "text": "订单"
         },
         {
           "pagePath": "pages/me/index",
           "text": "我的"
         }
       ]
     },
     "style": "v2",
     "sitemapLocation": "sitemap.json"
   }
   ```

4. 获取需要跳转到的 url      pages/web-view/index.js

   ```js
    // pages/web-view/index.js
    Page({
      data: {
        url:null
      },

      onLoad(options) {
        // console.log(options.url); // 这里地址就过来了,地址赋值给上面data里面的url
        this.setData({
          url:options.url
        })
      }
    })
   ```

5. 设置跳转到的页面里面   pages/web-view/index.wxml

   ```js
	<view wx:if="{{url}}" src="{{url}}"></view>
   ```

#### Tabbar & 首页会员卡片

```js
1. 会员
   - 积分
	 - 我的积分
   - 会员成长值(分数)
2. 定位点餐
3. 今天喝什么
   - 公众号文章跳转
4. 优惠券
5. 积分商城(雪王魔法阵)
```

1. 底部 Tabbar

```js
{
  "pages": [
    "pages/index/index",
    "pages/menu/index",
    "pages/order/index",
    "pages/me/index",
    "pages/web-view/index",
    "pages/product/detail"
  ],
  "window": {
    "backgroundTextStyle": "light",
    "navigationBarBackgroundColor": "#fff",
    "navigationBarTitleText": "Weixin",
    "navigationBarTextStyle": "black"
  },
  "tabBar": {
    "color": "#797979",
    "selectedColor": "#E60012",
    "list": [
      {
        "pagePath": "pages/index/index",
        "text": "首页",
        "iconPath": "./assets/images/home.png",
        "selectedIconPath": "./assets/images/home-selected.png"
      },
      {
        "pagePath": "pages/menu/index",
        "text": "点餐",
        "iconPath": "./assets/images/menu.png",
        "selectedIconPath": "./assets/images/menu-selected.png"
      },
      {
        "pagePath": "pages/order/index",
        "text": "订单",
        "iconPath": "./assets/images/order.png",
        "selectedIconPath": "./assets/images/order-selected.png"
      },
      {
        "pagePath": "pages/me/index",
        "text": "我的",
        "iconPath": "./assets/images/me.png",
        "selectedIconPath": "./assets/images/me-selected.png"
      }
    ]
  },
  "style": "v2",
  "sitemapLocation": "sitemap.json"
}
```

2. app.scss

```scss
/**app.wxss**/
.page {
  background-color: #fefefe;
  display: flex;
  flex-direction: column;
  align-items: center;
} 
```

##### 会员卡片

1. pages/index/index.wxml

```html
<view class="page">
<!-- 1. 轮播图-->
 <view wx:if="{{swiperList.length}}" class="swiper-container">
 <!--3. 我们怎么知道图片切换去切换小圆圈的状态呢，这里有个bindchange事件 -->
  <swiper bindchange="onSwiperChange" autoplay="true" interval="3000" duration="1000" circular="true">
   <!--1. 轮播里面包括图片，里面一个是轮播一个是轮播标识，里面一个是图片一个是跳转链接 -->
    <swiper-item wx:for="{{ swiperList }}" wx:key="index">
      <image bindtap="onSwiperTab" data-item="{{item}}" mode="aspectFill" src="{{ item.imgUri }}"></image>
    </swiper-item>
  </swiper>
  <view class="dots">
  <!--2. 如果 current == index  会有一个 active 属性-->
  <view class="dot {{current !== index || 'active'}}" wx:for="{{ swiperList }}" wx:key="index"></view>
  </view>
 </view>
    
 <!--2. 会员/积分区域 -->
 <view class="member-area">
 <!-- 左侧会员区域 -->
 <view class="vip-box">
 <image src="../../assets/images/vip-pic.png"></image>
 <view class="meta">
 <view class="title">微雪花会员</view>
  <!-- 拆分组件部分 -->
 <progress-bar value="{{ 33 }}" width="320rpx"/>
 <view class="tips">再升1级可享【升级礼包】等6项权益</view>
 </view>

 <!-- 右侧积分区域 -->
 <view class="coin-box">
 <image src="../../assets/images/coin.png"></image>
 <view class="currency">51</view>
 </view>
 </view> 
 </view>
</view>
```

2. pages/index/index.json

```js
{
  "navigationStyle": "custom",
  "usingComponents": {
     // 引入组件
    "progress-bar":"../../components/progress-bar/index"
  }
} 
```

3. 创建组件经验条部分  components/progress-bar/index.wxml

```html
<!-- 经验条组件类型1
<view class="track" style="{{!trackColor ? 'background-color:' + trackColor + ';' : ''}} {{ width ? 'width:' + width + ';' : ''}}">
  <view class="bar" style="{{ value > 0 ? 'width:' + value + '%;' : ''}} {{!color|| 'background-color:' + color + ';'}}">
  </view>
</view> -->

<!-- 经验条组件类型二 -->
<!-- 如果正常情况下，这里判断就很麻烦，所以这里指定了两个属性，在js文件中，设置具体内容 -->
<view class="track" style="{{ trackStyle }}">
  <view class="bar" style="{{ barStyle }}">
  </view>
</view>
```

4. components/progress-bar/index.json

```js
{
  "component": true,
  "navigationStyle": "custom",
  "usingComponents": {
  }
}
```

5. components/progress-bar/index.js

```js
// components/progress-bar/index.js
Component({
  properties: {
    // 接收参数 color 是条的颜色
    color:{
      type:String,
      value:''
    },
    // trackColor 是背景的颜色
    trackColor:{
      type:String,
      value:''
    },
    // value就是一个值，这里一般都是百分比
    value:{
      type:Number,
      value:0
    },
    // 如果不加width，那么是占满整个区域，如果指定了width那么就可以限制区域
    width:{
      type:String,
      value:''
    }
  },
  data: {
  trackStyle:'',
  barStyle:'',
  },
lifetimes:{
  attached(){
    // 两个style的产出，这里是 组件被放在页面的时候 就去执行函数
    this.buildTrackStyle();
    this.buildBarStyle();
  }
},

  methods: {
    // buildTrackStyle对轨道进行计算，就是背景
    buildTrackStyle(){
      // 定义初始值，如果下面两个条件都没达到，那么就给值里面塞进去一个空的 trackStyle
      let trackStyle = '';
      // 判断width是否存在，如果存在加入 width 属性
      // 语法糖：如果前面是真的，就是传入了 width 那么就不会执行后面的部分，如果前面是false，才会执行后面的代码

      // if(this.properties.width){
      //   trackStyle += `width:${this.properties.width
      // } 
      // 与下面类似
      !this.properties.width || (trackStyle += `width:${this.properties.width};`)

      !this.properties.trackStyle || (trackStyle += `background-color:${this.properties.trackStyle};`)
      this.setData({
        trackStyle
      })
    },
    buildBarStyle(){
        // 定义初始值
        let barStyle = '';
        // 判断width是否存在，如果存在加入 width 属性，这里不是随便加的，如果是在0~100之间才加入进去，否则就不加入，并且后面是个数字，所以要加入%
        (this.properties.value <= 0 && this.properties.value >100) || (barStyle += `width:${this.properties.value}%;`)

        !this.properties.color || (barStyle += `background-color:${this.properties.color};`)
        this.setData({
          barStyle
        })
    }
  }
})
```

6. components/progress-bar/index.scss

```js
/* components/progress-bar/index.wxss */
.track{
  // 进度条部分
  background-color: #ebebeb;
  height: 6rpx;
  width: 100%;
  border-radius: 3rpx;
  // 进度条里面是竖装的，这里需要超出隐藏掉
  overflow: hidden;
}
.bar{
  background-color: #E60012;
  height: 100%;
  width: 0;
}
```

7. pages/index/index.scss

```scss
.swiper-container{
  width: 100vw;
  height: 630rpx;
  position: relative;
  swiper{
    height: 100%;
    image{
      width: 100%;
      height: 100%;
      // 下面有一点的弧度
      border-bottom-left-radius: 20rpx;
      border-bottom-right-radius: 20rpx;
    }
  }
  // 固定的区域，轮播图里面的切换图片的小标识
  .dots{
    position: absolute;
    left: 50rpx;
    bottom: 58rpx;
    // 这样的话下面的 dot 小圆圈就可以按照flex进行排布
    display: inline-flex;
    .dot{
      width: 8rpx;
      height: 8rpx;
      background-color: #fff;
      opacity: .5;
      // 因为上面是正方块，所以这里应该是半径 4rpx 的圆
      border-radius: 4rpx;
      // 每个小圆的间隔是 4rpx
      margin-left: 4rpx;
      // 1s 过渡
      transition: all 1s;
      &.active {
        // 如果是被选中状态的话，那么这里就会从圆变成一个条状的切换样式
        width: 29rpx;
        opacity: 1;
      }
    }
  }
}
.member-area{
  margin-top: -40rpx;
  z-index: 2;
  overflow: hidden;
  width: 688rpx;
  height: 174rpx;
  border-radius: 16rpx;
  background-color: #fefefe;
  // 给盒子一个阴影
  box-shadow: 0px 0px 8px rgba(0,0,0,0.2);
  display: flex;
  // 将盒子里面元素在同一行排布
  flex-direction: row;
  // 排布在盒子的两端
  justify-content: space-between;
  // 使图标显示在中间位置
  padding: 30rpx;
  // 这样防止盒子因为 padding 变大
  box-sizing: border-box;
  .vip-box{
    display: flex;
    image{
      width: 100rpx;
      height: 100rpx;
      border-radius: 50rpx;
      overflow: hidden;
      margin-right: 26rpx;
      // 这样不会在空间不够的情况下使图片变形，默认情况下是1，空间不够自动缩小
      flex-shrink: 0;
    }
    .meta{
      .title{
        font-size: 32rpx;
        font-weight: bold;
        margin-bottom: 18rpx;
      }
      .tips{
        margin-top: 14rpx;
        color: #777777;
        font-size: 24rpx;
      }
    }
  }
  .coin-box{
    display: flex;
    flex-direction: column;
    justify-content: center;
    margin-right: -45rpx;
    image{
      width: 130rpx;
      height: 70rpx;
    }
    .currency{
      color: #d32d25;
      margin-left: 26rpx;
      font-weight: bold;
    }
  }
}
```

#### 手机号码快捷登录

```js
思路：
云调用的方式，云开发会给我们提供一个云调用的机制，我们可以载运函数里面直接拿到加密的data传到云函数，云函数就可以拿到手机号，拿到手机号以后，我们就只要把手机号码存储到我们的后台用户列表里面，用户列表就会根据这边的数据，这个用户列表也只是手机号码，不会拿到其他的东西，比较简化一点，这个手机号码拿到以后，我们就可以在数据库的权限里面只能看到自己的手机号码的权限，这样就可以绑定这个手机号码，可以知道某一个手机号码是不是属于他的，再根据这个对数据进行筛选。我们对数据筛选我们可以用ID，我们在数据库写的时候，有些数据只是他自己能看到的，我们就用数据权限的方式去分割，不需要有太多的对用户的关联操作。
登录比较简单一点就是：暂时这里不需要gwt，给一个token这样非常复杂的登录体系
只需要保持当前的session，我们可以在data里面存储一个手机号码，如果没有登录，我们还不知道他是谁，这里必须要授权登录，然后去数据库里面查找，再提供区分的服务，简单的鉴权，以手机号码为主，当前如果localStorage里面存储了手机号码，我们只需要对这个手机号码提供服务就可以了，如果当前不是这个手机号码，我们就可以让选择手机号码登录，再对手机号码进行存储
```

1. app.json 创建一个登录页面

```js
{
  "pages": [
    "pages/index/index",
    "pages/menu/index",
    "pages/order/index",
    "pages/me/index",
    "pages/web-view/index",
    "pages/product/detail",
    "pages/login/index"
  ],
  "window": {
    "backgroundTextStyle": "light",
    "navigationBarBackgroundColor": "#fff",
    "navigationBarTitleText": "蜜雪冰城",
    "navigationBarTextStyle": "black"
  },
  "tabBar": {
    "color": "#797979",
    "selectedColor": "#E60012",
    "list": [
      {
        "pagePath": "pages/index/index",
        "text": "首页",
        "iconPath": "./assets/images/home.png",
        "selectedIconPath": "./assets/images/home-selected.png"
      },
      {
        "pagePath": "pages/menu/index",
        "text": "点餐",
        "iconPath": "./assets/images/menu.png",
        "selectedIconPath": "./assets/images/menu-selected.png"
      },
      {
        "pagePath": "pages/order/index",
        "text": "订单",
        "iconPath": "./assets/images/order.png",
        "selectedIconPath": "./assets/images/order-selected.png"
      },
      {
        "pagePath": "pages/me/index",
        "text": "我的",
        "iconPath": "./assets/images/me.png",
        "selectedIconPath": "./assets/images/me-selected.png"
      }
    ]
  },
  "style": "v2",
  "sitemapLocation": "sitemap.json"
}
```

2. pages/index/index.wxml

```html
<view class="page">
  <image class="logo" src="../../assets/images/me-avatar.png"></image>
  <view class="logo-title">蜜雪冰城</view>
  <view class="intro">成为会员，立享更多优惠福利</view>
  <view class="login-tip">授权绑定手机号 为您提供更好的服务</view>
  <button open-type="getPhoneNumber" class="login-btn"  bindgetphonenumber="login">一键登录</button>
  <view class="cancel" bindtap="">取消</view>
</view>
```

3. pages/index.index.scss

```scss
@import '../../style/theme.scss';
.page{
  padding-top: 176rpx;
  .logo{
    width: 150rpx;
    height: 150rpx;
    border-radius: 75rpx;
    overflow: hidden;
    margin-bottom: 22rpx;
  }
  .logo-title{
    margin-bottom: 160rpx;
  }
  .intro{
    font-size: 37rpx;
    font-weight: bold;
    margin-bottom: 84rpx;
  }
  .login-tip{
    font-size: 20rpx;
    color: $gray-text-color;
  }
  .login-btn{
    width: 368rpx;
    height: 85rpx;
    background-color:$primary-color;
    color: white;
    border-radius: 10rpx;
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 42rpx;
    &.button-hover{
      opacity: 0.6;
    }
  }
  .cancel{
    color: #aaaaaa;
  }
}
```

4. style/theme.scss

```js
// 配置两个通用的颜色，需要的地方直接引入
$primary-color:#E60012;
$gray-text-color:#777777
```

5. 获取手机号暂时先不做，由于个人认证的用户无法获取手机号权限

```js
1. 先去创建 cloud-functions 文件夹
2. 然后去 project.config.json 中添加配置 "cloudfunctionRoot": "cloud-functions/",
    {
  "description": "项目配置文件",
  "packOptions": {
    "ignore": [],
    "include": []
  },
  "cloudfunctionRoot": "cloud-functions/",
  "miniprogramRoot": "miniprogram/",
  "compileType": "miniprogram",
  "projectname": "ts-sass-demo",
   "setting": {
       ...
   }
}
```

6. pages/login/index.js

```js
// pages/login/index.js
Page({

  /**
   * 页面的初始数据
   */
  data: {

  },
  login(e){
    // 注意这里如果是个人认证是没有办法拿到手机号的
    // console.log(e);
    const cloudId = e.detail.CloudID
    wx.cloud.callFunction({
      name:'get-phone-number',
      data:{
        weRunData: wx.clouod.CloudID(cloudId), // 这个 CloudID 值到云函数端会被替换
      }
    }).then(res=>{
      console.log(res);
    })
  },
  onLoad(options) {

  },
})
```

7. 选择做 如果想要看一下获取的都是那些信息，我们需要对云函数进行修改 

cloud-functions/get-phone-number/index.js

```js
// 云函数入口文件
const cloud = require('wx-server-sdk')

cloud.init()

// 云函数入口函数
exports.main = async (event, context) => {
   // return event.weRunData.data.phoneNumber
   // 改为
   return event.weRunData.data
}
// 然后这时候需要右键 cloud-functions/get-phone-number 文件夹-选择上传并部署所有文件
```

8. pages/index/index.js

```js
// pages/login/index.js
Page({

  /**
   * 页面的初始数据
   */
  data: {
  },
  login(e){
    // // 注意这里如果是个人认证是没有办法拿到手机号的
    // // console.log(e);
    // const cloudId = e.detail.CloudID
    // wx.cloud.callFunction({
    //   name:'get-phone-number',
    //   data:{
    //     weRunData: wx.clouod.CloudID(cloudId), // 这个 CloudID 值到云函数端会被替换
    //   }
    // }).then(res=>{
    //   // console.log(res);
    //   // 根据手机号码判断是否登录
    //   wx.setStorage("phoneNumber",res.result)
    //   // 跳转回来 如果使用 navigateBack 那么栈里面要是有多余的部分，就可以控制好多余的部分
    //   wx.navigateBack({
    //     delta:0
    //   })
    // })

    // 由于上面是个人用户，无法获取手机号，所以这里选择不去获取手机号做鉴权，直接跳转页面
    wx.navigateBack({
      delta: 0,
      success: (res) => {
        ""
      },
    })
    wx.showToast({
      title: '登录成功',
      icon:"success",
      mask:true
    })
  },
  onLoad(options) {
  },

})
```

9. 继续优化登录页面，可以自行引入vant组件，设置弹出层